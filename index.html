<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css">
    <link rel="stylesheet" href="./SINGU/active.css">
    <title>INDEX</title>
</head>
<body>
  

  <div class="form">

   

    <div class="tab-content">
      <div id="signup">
        <h1>login</h1>

      

          

          <div class="field-wrap">
           
            <input type="email" required autocomplete="on" placeholder=" Email Address"  id="emaillogin" name="email" />
          </div>

          <div class="field-wrap">
           
            <input type="password" required autocomplete="on" placeholder="password " id="passwordlogin" name="password" />
          </div>

          <button type="submit" class="button button-block" id='login' name="login">login</button>

        

        <BR></BR>
        <a href="./SINGU/avtivite.html">cree un compte</a>
      </div>



  
      

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
</body>
<!-- <div id="login-box"> -->




<!-- <script type="module">
// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword ,onAuthStateChanged,signOut} from "https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// const firebaseConfig = {
// apiKey: "AIzaSyCTlW9SwEPepKEViMs0LuYWqyt0bZUYbFA",
// authDomain: "activite-1820d.firebaseapp.com",
// databaseURL: "https://activite-1820d-default-rtdb.firebaseio.com",
// projectId: "activite-1820d",
// storageBucket: "activite-1820d.appspot.com",
// messagingSenderId: "416516314452",
// appId: "1:416516314452:web:b600b95d5f7d658786e4c1"
// };



// Initialize Firebase
const app = initializeApp(firebaseConfig);
    // Initialize Cloud Firestore and get a reference to the service
    const db = getFirestore(app);

    submitData.addEventListener('click', (e) => {
        let email = document.getElementById('email').value;
        let password = document.getElementById('password').value;
        let status= document.getElementById('status').value;
        let nom=document.getElementById('nom').value;
        let prenom=document.getElementById('prenom').value;

        addDoc(collection(db, "users"), {
            nom:nom,
            prenom:prenom,
            email: email,
            password: password,
            status:status
        });
        
        alert('inscription reussite');
         document.getElementById('email').value= "";
          document.getElementById('password').value ="";
         document.getElementById('status').value ="";
          document.getElementById('username').value ="";
         
          
    });






// submitconnexion.addEventListener('click', (e) => {

//     let emaillogin= document.getElementById('emaillogin').value;
//     let passwordlogin=document.getElementById('passwordlogin').value;
//     const q = query(collection(db, "users"), where("email", "==", emaillogin));

        
// let users ;
//         getDocs(q).then(docSnap => {
//             docSnap.forEach((doc)=> {
//                 users= doc.data();
//             });
//             if (typeof users !== 'undefined') {
//                 if (users.status ==="admin") {
//         document.getElementById('emaillogin').value ="";
//         document.getElementById('passwordlogin').value="";
//          window.location="./admin.html"
    
       
//       }else if (users.status ==="utilisateur") {
//         document.getElementById('emaillogin').value ="";
//         document.getElementById('passwordlogin').value="";
//         window.location="./guest.html"
    
//       }else{
//       alert('don\'t exist')
//       }
//             }else{
//                 alert('désolé vous ne figurez pas ici veuillez vous inscrire svp')
//             }
//             // console.log("Document data:", users[0]['email']);
//             console.log( users.status);
//         });
//     });




</script> -->
</html>

<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
    import {  getFirestore, setDoc, addDoc,doc, updateDoc,deleteDoc, getDoc, query, collection, where, getDocs, onSnapshot} from "https://www.gstatic.com/firebasejs/9.17.2/firebase-firestore.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDXdPAeUx3ajvFTdZD4S6Hre8Ecsp-S4l8",
      authDomain: "firestorelogin-bf279.firebaseapp.com",
      projectId: "firestorelogin-bf279",
      storageBucket: "firestorelogin-bf279.appspot.com",
      messagingSenderId: "1010327121270",
      appId: "1:1010327121270:web:7a4402058bc726fb8ede57"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    // Initialize Cloud Firestore and get a reference to the service
    const db = getFirestore(app);
  
  
//     sighUp.addEventListener('click', (e) =>{
  
//          let email = document.getElementById('email').value;
//           let password = document.getElementById('password').value;
//           let status= document.getElementById('status').value;
//           let username=document.getElementById('username').value;
      
//   addDoc(collection(db, "users"), {
    
//              username:username,
//              status:status,
//               email: email,
//               password: password
              
//   });
//   // window.location="login.html"
//   alert('user cree');
//             document.getElementById('email').value= "";
//             document.getElementById('password').value ="";
//             document.getElementById('status').value ="";
//             document.getElementById('username').value ="";
        
//     });



    login.addEventListener('click', (e) => {

let emaillogin= document.getElementById('emaillogin').value;
let passwordlogin=document.getElementById('passwordlogin').value;
const q = query(collection(db, "users"), where("email", "==", emaillogin));

    
let users ;
    getDocs(q).then(docSnap => {
        docSnap.forEach((doc)=> {
            users= doc.data();
        });
        if (typeof users !== 'undefined') {
            if (users.status ==="admin") {
    document.getElementById('emaillogin').value ="";
    document.getElementById('passwordlogin').value="";
     window.location="./SINGU/PAGE.html"

   
  }else if (users.status ==="user") {
    document.getElementById('emaillogin').value ="";
    document.getElementById('passwordlogin').value="";
    window.location="./SINGU/user.html"

  }else{
  alert('invalide')
  }
        }else{
            alert('cinvalide')
        }
        // console.log("Document data:", users[0]['email']);
        console.log( users.status);
    });
});

  </script>